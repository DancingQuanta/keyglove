<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Keyglove: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_keyglove.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-hand-110.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Keyglove
   &#160;<span id="projectnumber">Arduino</span>
   </div>
   <div id="projectbrief">Wearable wireless input device</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Keyglove Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Welcome to the <b>Keyglove</b> Arduino firmware source. This project is provided in full source form so that you can make the most of a very powerful and customizable platform, and (hopefully) documented in such a way that you can use it with as little effort as possible out of the box. All software required for use is freely available. The sketch itself is organized such that you will normally only need to edit the fewest possible number of files in order to achieve the functionality you want.</p>
<h1>Prerequisites</h1>
<p>The Keyglove Arduino sketch currently works only with the <b>Teensy++ 2.0 from PJRC</b> (or, I suppose, if you are really clever with an <a href="http://www.atmel.com/devices/sam3x8e.aspx">AT90USB128x</a> MCU in your own design). This board was chosen for its high I/O count, which is nice for Keyglove designs with a large number of sensors. The <a href="http://www.atmel.com/devices/sam3x8e.aspx">ATSAM3X8E</a> is planned for the next revision and custom controller, but for now the T++2 is the best choice and only supported platform.</p>
<p>Additionally, you can optionally include certain modular components in your chosen configuration, such as Bluetooth, motion, etc. Here is the hardware and software that you should be looking at:</p>
<h3>Required components:</h3>
<ol type="1">
<li><a href="https://www.pjrc.com/store/teensypp.html">Teensy++ 2.0 AT90USB128x microcontroller board</a></li>
<li><a href="http://arduino.cc/en/main/software#toc2">Arduino v1.0.6 IDE</a></li>
<li><a href="https://github.com/jrowberg/keyglove">Keyglove project source</a> (or <a href="https://github.com/jrowberg/keyglove/archive/master.zip">full Github repo ZIP</a>)</li>
<li><a href="https://www.pjrc.com/teensy/td_download.html">Teensyduino add-on for Arduino IDE</a></li>
</ol>
<h3>Optional components:</h3>
<ol type="1">
<li><a href="http://www.amazon.com/Kootek-Arduino-MPU-6050-gyroscope-accelerometer/dp/B008BOPN40">GY-521 breakout board (MPU-6050)</a> for motion</li>
<li><a href="http://www.inmojo.com/store/jeff-rowberg/item/wt12-uart-bluetooth-breakout-board">Bluegiga WT12 UART breakout board</a> for Bluetooth</li>
<li><a href="https://github.com/jrowberg/i2cdevlib/tree/master/Arduino">I2Cdevlib project Arduino source</a> (or <a href="https://github.com/jrowberg/i2cdevlib/archive/master.zip">full Github repo ZIP</a>) for motion sensor support code</li>
<li><a href="https://github.com/jrowberg/iwrap/tree/master/Arduino">iWRAP project Arduino source</a> (or <a href="https://github.com/jrowberg/iwrap/archive/master.zip">full Github repo ZIP</a> for WT12 Bluetooth module support code</li>
</ol>
<p>The <a href="https://www.facebook.com/media/set/?set=a.466087043425247.108696.160471600653461&amp;type=3">Keyglove Kit PCB</a> is currently undergoing some revisions and isn't available yet. When it is, it will be very highly recommended, since it makes connecting sensors and modular boards <em>significantly</em> easier.</p>
<p><b>NOTE!</b> The Teensy-based design currently requires the 3.3v modification done with the MCP1725 regulator from PJRC (or elsewhere), since all of the motion and wireless components that you may want to use here are also 3.3v systems. <b>MAKE SURE YOU DO THIS</b>, or otherwise know exactly what you are doing.</p>
<h1>Firmware Preparation</h1>
<p>To get the Keyglove firmware running on your hardware, you will need to do a few things first:</p>
<ol type="1">
<li>Install the Arduino v1.0.6 IDE</li>
<li>Install the Teensyduino add-on</li>
<li>Clone or download and extract the Keyglove project source</li>
<li><b>OPTIONAL:</b> Clone or download and extract the I2Cdevlib project source</li>
<li><b>OPTIONAL:</b> Clone or download and extract the iWRAP project source</li>
</ol>
<p>If you have obtained the I2Cdevlib and/or iWRAP library sources, then make sure you do the following as appropriate:</p>
<ol type="1">
<li>Copy/move the <code>/i2cdevlib/Arduino/I2Cdev</code> folder to <code>~/Arduino/libraries/I2Cdev</code></li>
<li>Copy/move the <code>/i2cdevlib/Arduino/MPU6050</code> folder to <code>~/Arduino/libraries/MPU6050</code></li>
<li>Copy/move the <code>/iwrap/Arduino</code> folder to <code>~/Arduino/libraries/iWRAP</code> *(note renamed folder)*</li>
</ol>
<p>This will ensure that the required libraries are in the right spot so that the Arduino IDE can find them. <b>If you already started the Arduino IDE by this stage, you will need to close and re-open it in order for the new libraries to be detected properly.</b></p>
<p>Once these steps are complete, all required software should be in place, and you can continue with loading and configuring the firmware.</p>
<h1>Firmware Configuration</h1>
<p>One of the beautiful things about the Keyglove is that it is not just one single device; it is actually a powerful, extensible platform that you can configure in many different ways, in terms of both hardware and software. Although the entire source tree may be edited, these are the files most likely to be of interest:</p>
<ul>
<li><code><a class="el" href="config_8h.html" title="USER-DEFINED: Modular hardware/architecture configuration definitions ">config.h</a></code> - <b>Modular hardware/architecture configuration file</b></li>
<li><code><a class="el" href="application_8cpp.html" title="USER-DEFINED: Custom application behavior definition ">application.cpp</a>/.h</code> - <b>Custom application behavior definition</b></li>
<li><code>application_stubs.h</code> - Custom application behavior stub/reference</li>
<li><code><a class="el" href="custom__protocol_8cpp.html" title="USER-DEFINED: Custom protocol filtering implementations ">custom_protocol.cpp</a>/.h</code> - Custom protocol filtering and functional addition</li>
<li><code><a class="el" href="version_8h.html" title="USER-DEFINED: Firmware version info definitions ">version.h</a></code> - Firmware version info</li>
</ul>
<p>The first two are the most important, and you might not need the rest at all. In any case, <code><a class="el" href="config_8h.html" title="USER-DEFINED: Modular hardware/architecture configuration definitions ">config.h</a></code> is the first file that you should glance through to see if anything needs to be changed. The current repo default assumes the following configuration:</p>
<ul>
<li>Teensy++ 2.0 board as the main host</li>
<li>Single MPU-6050 motion sensor on the back of the hand</li>
<li>USB connectivity for serial and keyboard/mouse HID</li>
<li>No Bluetooth support</li>
</ul>
<p>You can change this using the various <code>#define</code>'d macros in <code><a class="el" href="config_8h.html" title="USER-DEFINED: Modular hardware/architecture configuration definitions ">config.h</a></code>, if you need. This is about the most basic configuration you would probably want for a Keyglove (though you could go even further and remove the motion sensor). See the documentation for KG_HOSTIF and KG_MOTION for detail.</p>
<h1>Firmware Installation</h1>
<p>Now comes the moment of truth.</p>
<ol type="1">
<li>Connect the Teensy++ 2.0 board via USB to your host</li>
<li>Start the Arduino IDE</li>
<li>Open the <code><a class="el" href="keyglove_8ino.html" title="Arduino sketch definition file for Keyglove firmware. ">keyglove.ino</a></code> file from the project source folder</li>
<li>From the "Tools" menu, select "Board" and then "Teensy++ 2.0"</li>
<li>From the "Tools" menu, select "Serial Port" and then the correct port for your Teensy</li>
<li>From the "Tools" menu, select "USB Type" and then "Serial + Keyboard + Mouse + Joystick" (or your choice)</li>
<li>From the "Tools" menu, select "CPU Speed" and then "8MHz" *(required after 3.3v modification)</li>
<li>Click the "Upload" button, or press Ctrl+U (or Command+U on a Mac)</li>
</ol>
<p>If everything went smoothly, it should compile without error and flash through the Teensyduino add-on into your Teensy++ board. You should begin to see the LED on the board blink briefly once every three seconds. If so, then it worked! You can now open the Teensy's serial port and communicate using the KGAPI binary protocol, or you can generate HID input reports by connecting certain sensors together.</p>
<p>The default firmware has very little internal autonomous behavior built in, but this is easy to add. The following actions will be triggered with touches:</p>
<ul>
<li>AY touch = motion sensor enabled</li>
<li>AY release = motion sensor disabled</li>
<li>DY touch = 'A' key pressed</li>
<li>DY release = 'A' key released</li>
<li>GY release = 'A' key pressed and released</li>
</ul>
<p>Internally, the "GY touch" action is of course detected, but it does not do anything itself. The motion sensor will generate 100Hz data over the USB serial port while it is active, but it will not move the mouse cursor (without some modification to <code><a class="el" href="application_8h.html" title="USER-DEFINED: Custom application behavior declarations ">application.h</a></code>). For reference:</p>
<ul>
<li>The "Y" sensor is meant to go on the thumb tip</li>
<li>The "A" sensor is meant to go on the index fingertip</li>
<li>The "D" sensor is meant to go on the middle fingertip</li>
<li>The "G" sensor is meant to go on the ring fingertip</li>
<li>The "J" sensor is meant to go on the little fingertip</li>
</ul>
<p>In other words, the "AY" combination is touching the thumb tip to the index fingertip, and the "DY" combination is touching the thumb tip to the middle fingertip.</p>
<p>The above simple set of actions gives you a basic functional reference to the kinds of things you might do with the Keyglove's various sensors and its fully event-driven functionality. More test software is currently under development and will be published as soon as possible, with full source. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Nov 8 2014 23:44:43 for Keyglove by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
